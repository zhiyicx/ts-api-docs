(window.webpackJsonp=window.webpackJsonp||[]).push([[139],{498:function(s,n,a){"use strict";a.r(n);var t=a(42),e=Object(t.a)({},(function(){var s=this,n=s.$createElement,a=s._self._c||n;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("p",[s._v("本章将带领你在 "),a("strong",[s._v("CentOS")]),s._v(" "),a("code",[s._v("7.4")]),s._v(" 系统中安装 "),a("strong",[s._v("Nginx")]),s._v("。参考资料：")]),s._v(" "),a("ul",[a("li",[a("a",{ref:"noopener noreferrer",attrs:{href:"https://nginx.org/en/docs/configure.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("Building nginx from Sources"),a("OutboundLink")],1)])]),s._v(" "),a("h2",{attrs:{id:"下载"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#下载"}},[s._v("#")]),s._v(" 下载")]),s._v(" "),a("p",[s._v("我们打开 Nginx 的「"),a("a",{ref:"noopener noreferrer",attrs:{href:"https://nginx.org/en/download.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("下载页面"),a("OutboundLink")],1),s._v("」我们找到 "),a("code",[s._v("Stable version")]),s._v(" 列表中的版本，因为这是稳定版，推荐使用的版本，目前我这里最新的稳定版本是 "),a("code",[s._v("1.14.0")]),s._v(" 所以我以这个版本为例进行安装。")]),s._v(" "),a("p",[s._v("如下图：")]),s._v(" "),a("img",{attrs:{src:s.$withBase("/assets/img/guide/installation/nginx-download-page.png")}}),s._v(" "),a("p",[s._v("我们右键 "),a("code",[s._v("nginx-1.14.0")]),s._v(" 这个链接，选择复制链接地址，得到：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("https://nginx.org/download/nginx-1.14.0.tar.gz\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("这样的地址，然后我们登入 CentOS 服务器，进入家目录：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" ~\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("进入加目录后我们执行：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -L -o nginx-1.14.0.tar.gz https://nginx.org/download/nginx-1.14.0.tar.gz\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("下载完成。我们这个时候可以输入 "),a("code",[s._v("ls")]),s._v(" 命令查看文件列表进行确认。")]),s._v(" "),a("p",[s._v("接下来，我们将源码归档进行解压获得源码：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("tar -zxvf nginx-1.14.0.tar.gz\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("我们就得到了 "),a("code",[s._v("~/nginx-1.14.0")]),s._v(" 这个目录。")]),s._v(" "),a("h2",{attrs:{id:"编译前配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#编译前配置"}},[s._v("#")]),s._v(" 编译前配置")]),s._v(" "),a("p",[s._v("安装前，我们需要提前为 Nginx 创建一个运行用户和用户组（这里定义为 "),a("code",[s._v("nginx:nginx")]),s._v("，默认不登录不创建家目录）：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("groupadd")]),s._v(" nginx "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("useradd")]),s._v(" -s /sbin/nologin -g nginx -M nginx\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("然后在我们为其安装编译所需的工具和依赖：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("yum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y gc gcc gcc-c++ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\npcre pcre-devel "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\nzlib zlib-devel "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\nopenssl openssl-devel\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("安装完成依赖后，我们使用 cd 命令进入源码目录：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" ~/nginx-1.14.0\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"编译"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#编译"}},[s._v("#")]),s._v(" 编译")]),s._v(" "),a("p",[s._v("在上面的步骤中，我们以及完成了所需的安装和配置，并进入了源码目录。接下来，我们生成 "),a("code",[s._v("Makefile")]),s._v(" 所需的文件：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("./configure "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--user"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("nginx "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--group"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("nginx "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--prefix"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/nginx "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--sbin-path"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/nginx/nginx "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--conf-path"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/nginx/nginx.conf "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--pid-path"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/nginx/nginx.pid "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--http-log-path"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/var/log/nginx/access.log "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--with-http_ssl_module "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--with-http_v2_module "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--with-http_stub_status_module "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--with-http_gzip_static_module "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--with-pcre\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("p",[s._v("执行完成后，我们运行 "),a("code",[s._v("make")]),s._v(" 命令，运行完成后我们再运行 "),a("code",[s._v("make install")]),s._v(" 命令即可。")]),s._v(" "),a("h2",{attrs:{id:"方便设置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#方便设置"}},[s._v("#")]),s._v(" 方便设置")]),s._v(" "),a("p",[s._v("现在，我们 Nginx 的启动命令文件在 "),a("code",[s._v("/usr/local/nginx/nginx")]),s._v(" 这个位置，每次进入这里操作不是很方便。所以，我们可以做一个软链，然后在全局都可以找到了。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ln")]),s._v(" -s /usr/local/nginx/nginx /usr/local/sbin/nginx\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#命令"}},[s._v("#")]),s._v(" 命令")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("nginx")]),s._v(" 启动 Nginx")]),s._v(" "),a("li",[a("code",[s._v("nginx -t")]),s._v(" 检查 Nginx 配置文件")]),s._v(" "),a("li",[a("code",[s._v("nginx -s stop")]),s._v(" 停止 Nginx")]),s._v(" "),a("li",[a("code",[s._v("nginx -s quit")]),s._v(" 正常退出 Nginxx")])])])}),[],!1,null,null,null);n.default=e.exports}}]);