---
sidebarDepth: 3
---

# 通过宝塔面板安装运行环境
## 简单介绍宝塔面板
> 宝塔Linux面板是提升运维效率的服务器管理软件，支持一键LAMP/LNMP/集群/监控/网站/FTP/数据库/JAVA等100多项服务器管理功能。
  有30个人的专业团队研发及维护，经过200多个版本的迭代，功能全，少出错且足够安全，已获得全球百万用户认可安装。运维要高效，装宝塔

**由于命令行安装环境对于很多用户来说学习成本太高，所以推荐一款可视化的环境运维产品 [宝塔面板](https://www.bt.cn/?invite_code=MV9iY3F0dGI=)
大部分的场景只需要免费版即可**

:::danger
以下的所有操作都默认在8888端口下进行
:::

## 安装步骤
### 找到合适服务器操作系统的版本
1. 方案一：在[宝塔官网](https://www.bt.cn/?invite_code=MV9vbWJxdWY=)登录后，在管理后台导航栏里面点击安装；

2. 方案二：[宝塔面板官方安装教程](https://www.bt.cn/bbs/thread-19376-1-1.html)
例如我现在有一台 Centos 8.*的服务器, 打开上面的页面之后，找到下图中的内容

```shell script
yum install -y wget && wget -O install.sh http://download.bt.cn/install/install_6.0.sh && sh install.sh
```

<img alt="Centos 8.*安装宝塔面板" :src="$withBase('/assets/img/centos-install-bt.png')" />

将上面的命令粘贴到服务器的命令行中，回车然后等待运行结束
命令行中会提示

```shell script
Bt-Panel: http://ip:8888/xxxx
username: username
password: password
```

的内容，并提示你放行服务器的安全组`腾讯`,`阿里云`都需要放行



### 安全组放行

到服务器所在的厂商，放行实例安全组的 `8888`端口入规则，当然你可以自定义这个端口号，
可以在服务器的命令行中操作，在命令行中输入
```shell script
bt
```
然后回车，出现
```shell script
===============宝塔面板命令行==================
(1) 重启面板服务           (8) 改面板端口
(2) 停止面板服务           (9) 清除面板缓存
(3) 启动面板服务           (10) 清除登录限制
(4) 重载面板服务           (11) 取消入口限制
(5) 修改面板密码           (12) 取消域名绑定限制
(6) 修改面板用户名         (13) 取消IP访问限制
(7) 强制修改MySQL密码      (14) 查看面板默认信息
(22) 显示面板错误日志      (15) 清理系统垃圾
(23) 关闭BasicAuth认证     (16) 修复面板(检查错误并更新面板文件到最新版)
(24) 关闭谷歌认证          (17) 设置日志切割是否压缩
(25) 设置是否保存文件历史副本  (18) 设置是否自动备份面板
(0) 取消
===============================================
请输入命令编号：
```
输入8，然后更改为你想设置的端口号，并修改对应的服务器防安全组放行端口

### 安装所需环境

登录宝塔面板地址，在左侧菜单中点击 `软件商店`
并安装 `php 7.4`, `nginx 1.21`, `mysql 5.7`, `redis 5.*/6.*`
安装需要的时间由服务器的硬件决定

安装过程宝塔面板页面的左上角有安装任务的数量，当安装成功后任务数量会清零
如果没有以外发生，这时候环境就安装完成了

### 安装PHP扩展
等待上一步的安装完全安装成功之后，在`软件商店`中找到安装过的 `PHP 7.4`
点击设置看到如下界面
<img alt="PHP 7.4" :src="$withBase('/assets/img/php-7.4.png')" />
点击`扩展安装`, 选择
`fileinfo`,
`opcache`,
`redis`,
`exif`,
`imagemagick`
依旧需要等待安装完成

#### 禁用函数

php 安装后会自带禁用掉部分函数，需要删除 `putenv`

**环境安装结束**

## 添加站点
### 添加站点
1. 回到面板，点击左侧菜单的 `网站`，点击点击右侧区域的绿色按钮 `添加站点`
2. 按要求填写弹出框中的内容
3. 数据库选择 `mysql`，字符集选择 `utf8mb4`，如果填写了域名，会以分割的方式使用`_`连接生成一个数据库名和相同的数据库账号
4. 点击提交，页面刷新，出现新添加的站点
### 克隆授权仓库
如果按上面的步骤创建了站点，在站点所在的目录 比如在上一步中填写的域名是 xxx.com，
面板会生成 /www/wwwroot/xxx.com的目录，此时目录中会有一些默认的内容
这时候需要使用到服务器命令行操作了
1. cd /www/wwwroot 回车
2. git clone https://github.com/zhiyicx/xxxxx xxx.com `xxxx为你的授权仓库名字`
却发现提示xxx.com目录不是空的，那我们需要做一件事情，清空这个目录

>目录里面有个.user.ini的文件怎么都删除不掉，就需要在宝塔控制面板上进入这个目录，在面板上操作删除这个目录，具体的原因就不多说了

然后我们再来clone仓库，或者

```shell script
git clone https://github.com/zhiyicx/xxxxx (该地址为您的源代码地址)

```
让git自己生成一个目录，上面的命令会生成`xxxxx`目录。

如果你克隆仓库的时候执行的是后面的这个命令，
那就需要在克隆完成之后，在面板的网站列表重新指定一下站点的目录位置，设置按钮在站点右侧
点击之后看到如下弹窗
<img alt="PHP 7.4" :src="$withBase('/assets/img/site-setting.png')" />

点击网站目录，选择上面的 `/www/wwwroot/xxxxx`目录，然后点击保存，

**运行目录必须选择 `public`目录**

**必须将程序目录设置为www:www这个用户和用户组所有（宝塔面板安装的php默认使用此用户和用户组运行）**
1. 进入站点列表
2. 点击要设置的站点的根目录
3. 进入`/www/wwwroot/`目录中，右侧有`权限`按钮，点击后会弹出窗口，选择www并设置755权限，并应用到子目录
<img :src="$withBase('/assets/img/guide/installation/specified- permission@2x.png')" />
然后确定就ok了
4. !!注意!!: 使用命令行执行过操作后，都建议使用此方法来修正程序运行所需要的权限，避免不可预知的权限问题出现 

**伪静态必须选择 `laravel5`**

SSL证书可以根据你自己的要求来处理，一般选择 `Let's Encrypt`来处理

**网站配置完成**

后面的步骤接着 [基础配置](/guide/installation/install-plus.html#%E5%9F%BA%E7%A1%80%E9%85%8D%E7%BD%AE)
往下执行即可